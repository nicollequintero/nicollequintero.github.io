<!DOCTYPE HTML>
<html>
<head>
	<meta charset="UTF-8">
	<link type:"text/css" rel="stylesheet" href="play2.css">
	<link href='http://fonts.googleapis.com/css?family=Oswald:700|Roboto+Slab:300' rel='stylesheet' type='text/css'>
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
	<!--<meta name="viewport" content="width=device-width, initial-scale =1.0, user-scalable =yes">-->
	<title>Got Honey?</title>
</head>

<body onLoad="myObject.printOut();">
	<header>
		<span>Got Honey?</span>
	</header>
	<nav>
		<p> <span>Objective:</span> <br> Use the navigation buttons to help the ant get to the pot of honey. <br><br>You won't be able to get through those anteasters, so hurry up before time is over! </p>
	</nav>
	
	<main id="forest">
		<article id="babyBear"></article>
		<article class = "tree" id ="tree1"></article>
		<article class = "tree" id ="tree2"></article>
		<article class = "tree" id ="tree3"></article>
		<article class = "tree" id ="tree4"></article>
		<article class = "tree" id ="tree5"></article>
		<article class = "tree" id ="tree6"></article>
		<article class = "tree" id ="tree7"></article>
		<article class = "tree" id ="tree8"></article>
		<article class = "tree" id ="tree9"></article>
		<article class = "tree" id ="tree10"></article>
		<article id = "honey"></article>
	</main>
	
	<aside>
		
		<section id="buttons">
			
			<button type="button" id="startButton" onClick="createRandomEnvironment(); clock = setInterval(function(){updateTimer()},1000);">Start Game</button>

			<table>
				<tr>
					<td></td>
					<td><button type="button" onClick="myObject.moveUp();">&#8593;</button></td>
					<td></td>
				</tr>
				<tr>
					<td><button type="button" onClick="myObject.moveLeft();">&#8592;</button></td>
					<td></td>
					<td><button type="button" onClick="myObject.moveRight();">&#8594;</button></td>
				</tr>
				<tr>
					<td></td>
					<td><button type="button" onClick="myObject.moveDown();">&#8595;</button></td>
					<td></td>
				</tr>
			</table>
		</section>
	</aside>
	
	<footer>
		<button type="button" onClick="createRandomEnvironment();">Move those anteaters around!</button>
		<p id="timer">Press Start!</p>
	</footer>


</body>

<script type="text/javascript">

var startTime = 0;
var clock;
var size = 30;

var myObject =  {
	outline: "",
	top:0,
	left:0,
	printOut: function () {
			document.getElementById("babyBear").style.top =  myObject.top+"px";
			document.getElementById("babyBear").style.left =  myObject.left+"px";
		},
	moveUp: function () {
			if(myObject.top>0 && noTreeThere(myObject.top-size, myObject.top, myObject.left, myObject.left+size)) {
			myObject.top-=size;
			console.log("top margin is"+myObject.top);
			myObject.printOut();
			gotHoney(); }
		},
	moveDown: function () {
			if(myObject.top<450 && noTreeThere(myObject.top+size, myObject.top+size+size, myObject.left, myObject.left+size)) {
			myObject.top+=size;
			console.log("top margin is"+myObject.top);
			myObject.printOut(); 
			gotHoney();}
		},
	moveLeft: function () {
			if(myObject.left>0 && noTreeThere(myObject.top, myObject.top+size, myObject.left-size, myObject.left)) {
			myObject.left-=size;
			console.log("left margin is"+myObject.left);
			myObject.printOut(); 
			gotHoney();}
		},
	moveRight: function () {
			if(myObject.left<450 && noTreeThere(myObject.top, myObject.top+size, myObject.left+size, myObject.left+size+size)) {
			myObject.left+=size;
			console.log("left margin is"+myObject.left);
			myObject.printOut(); 
			gotHoney();}
		},
};

var allTrees = [document.getElementById("tree1"),document.getElementById("tree2"),document.getElementById("tree3"),document.getElementById("tree4"),document.getElementById("tree5"),document.getElementById("tree6"),document.getElementById("tree7"),document.getElementById("tree8"),document.getElementById("tree9"),document.getElementById("tree10")];

function createRandomEnvironment () {
	//go through the allTrees array one element at a time


	for (var x = 0; x < allTrees.length; x++) {
		assignTreeRandomProperties(allTrees[x]);
	};
}

function updateTimer () {	
	//if time is up, stop clock and show game over
	if(startTime== 20)
		{ 	clearInterval(clock); 
			document.getElementById("forest").innerHTML = "GAME OVER!";
			return; }
	
	if(startTime == 10)
			createRandomEnvironment ();
	

	startTime+=1;

	document.getElementById("timer").innerHTML = (startTime);
	
	if(startTime ==1)
		document.getElementById("timer").innerHTML = startTime +" second";
	else
		document.getElementById("timer").innerHTML = startTime +" seconds";
}

function assignTreeRandomProperties(tree) {
	
	var newTreeLeft = randomIntFromInterval(30,410);
	var newTreeTop = randomIntFromInterval(30,410);
	tree.style.top = newTreeTop+"px";;
	tree.style.left = newTreeLeft+"px";;
	tree.style.visibility="visible";

	//if the tree would fall on the honey, assign new random properties to avoid this
	if ((newTreeTop+60 >= 410) && (newTreeLeft+90 >= 410))
		assignTreeRandomProperties(tree);
}

function randomIntFromInterval(min,max)
{
	//return a random number that is rounded to the nearest size multiple
    return Math.round((Math.floor(Math.random()*(max-min+1)+min))/size)*size;
}

function noTreeThere (top, bottom, left, right) {
	//go through the allTrees array one element at a time
	for (var x = 0; x < allTrees.length; x++) {
		if (checkEachTree (allTrees[x], top, bottom, left, right) == false)
			return false;	
	};

	return true;
}

function checkEachTree (tree, top, bottom, left, right) {
	//caculate the top, bottom, left and right edges of the tree
	var treeTop = getTopValue (tree);
	var treeBottom = getHeightValue (tree) + treeTop;
	var treeLeft = getLeftValue (tree);
	var treeRight = getWidthValue (tree) + treeLeft;

	//if the new position is within the tree, don't allow the move to occur
	if ((top >= treeTop && top <= treeBottom) && (bottom >= treeTop && bottom <= treeBottom) && (left >= treeLeft && left <= treeRight) && (right >= treeLeft && right <= treeRight))
					{ console.log("there is a tree there"); return false; }

	else
		return true;
}

function gotHoney () {
	if (myObject.top>=410 && myObject.left>=410)
		{	clearInterval(clock); 
			document.getElementById("forest").innerHTML = "You Made It!";
		}
}

//get the "top" value for this element as set in CSS
function getTopValue (obj)
{
	var style = window.getComputedStyle(obj);
	var top = style.getPropertyValue('top');
	return parseInt(top.replace("px",""));
}

//get the "height" value for this element as set in CSS
function getHeightValue (obj)
{
	var style = window.getComputedStyle(obj);
	var height = style.getPropertyValue('height');
	return parseInt(height.replace("px",""));
}

//get the "left" value for this element as set in CSS
function getLeftValue (obj)
{
	var style = window.getComputedStyle(obj);
	var left = style.getPropertyValue('left');
	return parseInt(left.replace("px",""));
}

//get the "width" value for this element as set in CSS
function getWidthValue (obj)
{
	var style = window.getComputedStyle(obj);
	var width = style.getPropertyValue('width');
	return parseInt(width.replace("px",""));
}

</script>

</html>

