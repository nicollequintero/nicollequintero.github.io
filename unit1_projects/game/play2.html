<!DOCTYPE HTML>
<html>
<head>
	<meta charset="UTF-8">
	<link type:"text/css" rel="stylesheet" href="play2.css">
	<link href='http://fonts.googleapis.com/css?family=Oswald:700|Roboto+Slab:300' rel='stylesheet' type='text/css'>
	<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
	<!--<meta name="viewport" content="width=device-width, initial-scale =1.0, user-scalable =yes">-->
	<title>Got Honey?</title>
</head>

<body onLoad="myObject.printOut();">
	<header>
		<span>Got Honey?</span>
	</header>
	<nav>
		<p> <span>Objective:</span> <br> Use the navigation buttons to help the ant get to the pot of honey. <br><br>You won't be able to get through those anteasters, so watch out! <br><br> You have 20 seconds, beware that the anteaters don't sit still!</p>
	</nav>
	
	<main id="forest">
		
		<article id="ant"></article>
		<article id = "honey"></article>
		
	</main>
	
	<aside>
		
		
			
	
		<section id="startButtons">
			
			<button type="button" id="easyButton" onClick="createAntEaters(7); createRandomEnvironment(); clock = setInterval(function(){updateTimer()},1000); disableMedium(); disableHard();">Easy</button>

			<button type="button" id="mediumButton" onClick="createAntEaters(14); createRandomEnvironment(); clock = setInterval(function(){updateTimer()},1000); disableEasy(); disableHard();">Medium</button>

			<button type="button" id="hardButton" onClick="createAntEaters(41); createRandomEnvironment(); clock = setInterval(function(){updateTimer()},1000); disableMedium(); disableEasy();">Hard</button>
		
		</section>	

		<section id="navButtons">
			<table>
				<tr>
					<td></td>
					<td><button type="button" onClick="myObject.moveUp();">&#8593;</button></td>
					<td></td>
				</tr>
				<tr>
					<td><button type="button" onClick="myObject.moveLeft();">&#8592;</button></td>
					<td></td>
					<td><button type="button" onClick="myObject.moveRight();">&#8594;</button></td>
				</tr>
				<tr>
					<td></td>
					<td><button type="button" onClick="myObject.moveDown();">&#8595;</button></td>
					<td></td>
				</tr>
			</table>
		</section>

		<button type="button" id="replayButton" onClick="history.go(0)">Play Again</button>

	</aside>
	
	<footer>
		<button type="button" onClick="createRandomEnvironment();">Move those anteaters around!</button>
		<p id="timer">Choose Level</p>
	</footer>


</body>

<script type="text/javascript">

var startTime = 0;
var clock;
var size = 30;

var myObject =  {
	top:0,
	left:0,
	printOut: function () {
			document.getElementById("ant").style.top =  myObject.top+"px";
			document.getElementById("ant").style.left =  myObject.left+"px";
		},
	moveUp: function () {
			if(myObject.top>0 && noAnteaterThere(myObject.top-size, myObject.top, myObject.left, myObject.left+size)) {
			myObject.top-=size;
			console.log("top margin is"+myObject.top);
			myObject.printOut();
			gotHoney(); }
		},
	moveDown: function () {
			if(myObject.top<550 && noAnteaterThere(myObject.top+size, myObject.top+size+size, myObject.left, myObject.left+size)) {
			myObject.top+=size;
			console.log("top margin is"+myObject.top);
			myObject.printOut(); 
			gotHoney();}
		},
	moveLeft: function () {
			if(myObject.left>0 && noAnteaterThere(myObject.top, myObject.top+size, myObject.left-size, myObject.left)) {
			myObject.left-=size;
			console.log("left margin is"+myObject.left);
			myObject.printOut(); 
			gotHoney();}
		},
	moveRight: function () {
			if(myObject.left<650 && noAnteaterThere(myObject.top, myObject.top+size, myObject.left+size, myObject.left+size+size)) {
			myObject.left+=size;
			console.log("left margin is"+myObject.left);
			myObject.printOut(); 
			gotHoney();}
		},
};

var allAnteaters = [];

function createAntEaters (num) {

	//setting up variable to allow for rewriting inner HTML
	var linepart2 = "\"></article>";
	var linepart1 = "<article class = \"anteater\" id =\"anteater";
	var putlinestogether = "";
	var newHTML = "<article id=\"ant\"></article>";
	var el = "";

	//add a new anteater line based on the difficult chosen
	for (var x = 1; x<= num; x++) {	
		
		putlinestogether = linepart1+x+linepart2;
		newHTML= newHTML.concat(putlinestogether);
		};	

	//add the honey to the end of the HTML
	newHTML = newHTML.concat("<article id = \"honey\"></article>")

	document.getElementById("forest").innerHTML= newHTML;

	//fill the array with each anteater
	for (var x = 1; x<= num; x++) {	
		
		el = "anteater"+x;
		allAnteaters.push(document.getElementById(el));
		};	
} 

function disableEasy () {

	document.getElementById("easyButton").disabled=true;
	document.getElementById("easyButton").style.backgroundColor="#d3d3d3";
	document.getElementById("easyButton").style.color="#a8a8a8";
}

function disableMedium () {

	document.getElementById("mediumButton").disabled=true;
	document.getElementById("mediumButton").style.backgroundColor="#d3d3d3";
	document.getElementById("mediumButton").style.color="#a8a8a8";
}

function disableHard () {

	document.getElementById("hardButton").disabled=true;
	document.getElementById("hardButton").style.backgroundColor="#d3d3d3";
	document.getElementById("hardButton").style.color="#a8a8a8";
}


function createRandomEnvironment () {
	//go through the allAnteaters array one element at a time to assign random properties
	for (var x = 0; x < allAnteaters.length; x++) {
		assignAnteaterRandomProperties(allAnteaters[x]);
	};
}

function moveAnteaters() {
	//go through the allAnteaters array one element at a time to assign random properties
	
	console.log("entering moveAnteaters");
	for (var x = 0; x < allAnteaters.length; x++) {
		moveEachAnteater(allAnteaters[x]);
	};

}

function moveEachAnteater(anteater) {
		
	var newLeftpos = getLeftValue(anteater) - size;

	//if new position would fall within honey, don't move anteater
	if(newLeftpos+90 >=610 && getTopValue(anteater)>= 510)
		return;

	anteater.style.left = newLeftpos+"px";
	anteater.style.visibility="visible";
		

	//check if the Anteater has moved on top of the ant, if so, end the game
	//caculate the top, bottom, left and right edges of the anteater
	var anteaterTop = getTopValue (anteater);
	var anteaterBottom = getHeightValue (anteater) + anteaterTop;
	var anteaterLeft = getLeftValue (anteater);
	var anteaterRight = getWidthValue (anteater) + anteaterLeft;

	if ((myObject.top >= anteaterTop && myObject.top <= anteaterBottom) && (myObject.top+10 >= anteaterTop && myObject.top+10 <= anteaterBottom) && (myObject.left >= anteaterLeft && myObject.left <= anteaterRight) && (myObject.left+10 >= anteaterLeft && myObject.left+10 <= anteaterRight))
			{ 	clearInterval(clock); 
			document.getElementById("forest").innerHTML = "YOU\'VE BEEN EATEN!";
			disableEasy();
			disableMedium();
			disableHard();
			document.getElementById("replayButton").style.visibility ="visible";
			return; }

}

function updateTimer () {	
	
	//if time is up, stop clock, show game over and enable replay button
	if(startTime== 20)
		{ 	clearInterval(clock); 
			document.getElementById("forest").innerHTML = "GAME OVER!";
			disableEasy();
			disableMedium();
			disableHard();
			document.getElementById("replayButton").style.visibility ="visible";
			return; }

	//move the clock forward and move the anteaters
	startTime+=1;
	moveAnteaters();

	
	//print the time out in the counter
	if(startTime ==1)
		document.getElementById("timer").innerHTML = startTime +" second";
	else
		document.getElementById("timer").innerHTML = startTime +" seconds";
}


function assignAnteaterRandomProperties(anteater) {
	
	var newAnteaterLeft = randomIntFromInterval(30,1200);
	var newAnteaterTop = randomIntFromInterval(30,600);
	anteater.style.top = newAnteaterTop+"px";;
	anteater.style.left = newAnteaterLeft+"px";;
	anteater.style.visibility="visible";

	//if the anteater would fall on the honey, assign new random properties to avoid this
	if ((newAnteaterTop+60 >= 410) && (newAnteaterLeft+90 >= 410))
		assignAnteaterRandomProperties(anteater);
}

function randomIntFromInterval(min,max)
{
	//return a random number that is rounded to the nearest size multiple
    return Math.round((Math.floor(Math.random()*(max-min+1)+min))/size)*size;
}

function noAnteaterThere (top, bottom, left, right) {
	//go through the allAnteaters array one element at a time to check if an anteater is in the way 
	for (var x = 0; x < allAnteaters.length; x++) {
		if (checkEachAnteater (allAnteaters[x], top, bottom, left, right) == false)
			return false;	
	};

	return true;
}

function checkEachAnteater (anteater, top, bottom, left, right) {
	//caculate the top, bottom, left and right edges of the anteater
	var anteaterTop = getTopValue (anteater);
	var anteaterBottom = getHeightValue (anteater) + anteaterTop;
	var anteaterLeft = getLeftValue (anteater);
	var anteaterRight = getWidthValue (anteater) + anteaterLeft;

	//if the new position is within the anteater, don't allow the move to occur
	if ((top >= anteaterTop && top <= anteaterBottom) && (bottom >= anteaterTop && bottom <= anteaterBottom) && (left >= anteaterLeft && left <= anteaterRight) && (right >= anteaterLeft && right <= anteaterRight))
					{ console.log("there is a anteater there"); return false; }

	else
		return true;
}

function gotHoney () {
	if (myObject.top>=510 && myObject.left>=610)
		{	clearInterval(clock); 
			document.getElementById("forest").innerHTML = "You Made It!";
			disableEasy();
			disableMedium();
			disableHard();
			document.getElementById("replayButton").style.visibility ="visible";
			return; 
		}
}

//get the "top" value for this element as set in CSS
function getTopValue (obj)
{
	var style = window.getComputedStyle(obj);
	var top = style.getPropertyValue('top');
	return parseInt(top.replace("px",""));
}

//get the "height" value for this element as set in CSS
function getHeightValue (obj)
{
	var style = window.getComputedStyle(obj);
	var height = style.getPropertyValue('height');
	return parseInt(height.replace("px",""));
}

//get the "left" value for this element as set in CSS
function getLeftValue (obj)
{
	var style = window.getComputedStyle(obj);
	var left = style.getPropertyValue('left');
	return parseInt(left.replace("px",""));
}

//get the "width" value for this element as set in CSS
function getWidthValue (obj)
{
	var style = window.getComputedStyle(obj);
	var width = style.getPropertyValue('width');
	return parseInt(width.replace("px",""));
}

</script>

</html>

